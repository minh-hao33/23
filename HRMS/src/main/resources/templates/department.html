
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Th√¥ng Tin Ph√≤ng Ban</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
        }
        th {
            background-color: #f2f2f2;
            text-align: left;
        }
        th:first-child, td:first-child {
            width: 50px; /* ƒêi·ªÅu ch·ªânh ƒë·ªô r·ªông n·∫øu c·∫ßn */
        }
        /* Ki·ªÉu d√°ng cho modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            -top: 60px;
        }
        .modal-content {
            background-color: #fff;
            margin: 5% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 40%;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            border-radius: 10px;
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }
        .close:hover{
            text-decoration: none;
            cursor: pointer;
        }
        form {
            display: flex;
            flex-direction: column;
        }
        label {
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="text"] {
            margin-bottom: 15px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        input[type="submit"] {
            padding: 10px;
            border: none;
            border-radius: 5px;
            background-color: #888;
            color: white;
            font-size: 16px;
            cursor: pointer;
        }
        input[type="submit"]:hover {
            background-color: #888;
        }
        /* Ki·ªÉu d√°ng cho thanh t√¨m ki·∫øm */
        .search-container {
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
        }
        .search-container input[type="text"] {
            width: 300px;
            padding: 10px 20px;
            border: 1px solid #ddd;
            border-radius: 50px;
            font-size: 16px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        .search-container input[type="text"]:focus {
            border-color: #888;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            outline: none;
        }
        /* C√°ch b·∫£ng 10px */
        #addDepartmentBtn {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
<h1>Th√¥ng Tin Ph√≤ng Ban</h1>
<div class="search-container">
    <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm...">
</div>
<button id="addDepartmentBtn">Th√™m Ph√≤ng Ban</button>
<table id="departmentTable">
    <thead>
    <tr>
        <th>STT</th>
        <th>T√™n Ph√≤ng Ban</th>
        <th>T√™n Nh√¢n Vi√™n</th>
        <th>Vai Tr√≤</th>
        <th>H√†nh ƒê·ªông</th>
    </tr>
    </thead>
    <tbody>
    <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c ch√®n v√†o ƒë√¢y b·∫±ng JavaScript -->
    </tbody>
</table>

<!-- The Modal -->
<div id="myModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2 id="modalTitle">Th√™m Ph√≤ng Ban M·ªõi</h2>
        <form id="addDepartmentForm">
            <label for="departmentName">T√™n Ph√≤ng Ban:</label>
            <input type="text" id="departmentName" name="departmentName">
            <label for="userName">T√™n Nh√¢n Vi√™n:</label>
            <input type="text" id="userName" name="userName">
            <label for="roleName">Vai Tr√≤:</label>
            <input type="text" id="roleName" name="roleName">
            <input type="submit" value="Th√™m Ph√≤ng Ban">
        </form>
    </div>
</div>

<script>
    let editIndex = null;

    // H√†m ƒë·ªÉ ƒëi·ªÅn d·ªØ li·ªáu v√†o b·∫£ng
    function populateTable(data) {
        const tableBody = document.getElementById('departmentTable').getElementsByTagName('tbody')[0];
        tableBody.innerHTML = ''; // X√≥a c√°c h√†ng hi·ªán c√≥
        data.forEach((department, index) => {
            const row = tableBody.insertRow();
            row.insertCell(0).textContent = index + 1; // S·ªë th·ª© t·ª±
            row.insertCell(1).textContent = department.departmentName;
            row.insertCell(2).textContent = department.userName;
            row.insertCell(3).textContent = department.roleName;
            const actionCell = row.insertCell(4);
            actionCell.innerHTML = `
            <button onclick="editDepartment(${index}, '${department.departmentName}', '${department.userName}', '${department.roleName}')">‚úèÔ∏è</button>
            <button onclick="deleteDepartment(${index})">üóëÔ∏è</button>
        `;
        });
    }

    // L·∫•y d·ªØ li·ªáu t·ª´ API backend
    async function fetchData() {
        try {
            const response = await fetch('/api/v1/departments/all'); // ƒêi·ªÅu ch·ªânh URL ƒë·ªÉ ph√π h·ª£p v·ªõi endpoint API c·ªßa b·∫°n
            const data = await response.json();
            populateTable(data);
        } catch (error) {
            console.error('L·ªói khi l·∫•y d·ªØ li·ªáu:', error);
        }
    }

    // H√†m x·ª≠ l√Ω khi nh·∫•n n√∫t Th√™m Ph√≤ng Ban
    function addDepartment() {
        editIndex = null;
        document.getElementById('modalTitle').textContent = 'Th√™m Ph√≤ng Ban M·ªõi';
        document.getElementById('departmentName').value = '';
        document.getElementById('userName').value = '';
        document.getElementById('roleName').value = '';
        document.getElementById('addDepartmentForm').querySelector('input[type="submit"]').value = 'Th√™m Ph√≤ng Ban';
        const modal = document.getElementById('myModal');
        modal.style.display = 'block';
    }

    // H√†m x·ª≠ l√Ω khi g·ª≠i bi·ªÉu m·∫´u
    document.getElementById('addDepartmentForm').addEventListener('submit', function(event) {
        event.preventDefault();
        const departmentName = document.getElementById('departmentName').value;
        const userName = document.getElementById('userName').value;
        const roleName = document.getElementById('roleName').value;

        if (editIndex !== null) {
            // Logic ƒë·ªÉ c·∫≠p nh·∫≠t ph√≤ng ban (v√≠ d·ª•: g·ª≠i d·ªØ li·ªáu c·∫≠p nh·∫≠t ƒë·∫øn backend)
            console.log('C·∫≠p nh·∫≠t Ph√≤ng Ban:', { departmentName, userName, roleName });
        } else {
            // Logic ƒë·ªÉ th√™m ph√≤ng ban m·ªõi (v√≠ d·ª•: g·ª≠i d·ªØ li·ªáu ƒë·∫øn backend)
            console.log('Ph√≤ng Ban M·ªõi:', { departmentName, userName, roleName });
        }

        // ƒê√≥ng modal
        document.getElementById('myModal').style.display = 'none';
    });

    // ƒê√≥ng modal khi ng∆∞·ªùi d√πng nh·∫•n v√†o <span> (x)
    document.getElementsByClassName('close')[0].onclick = function() {
        document.getElementById('myModal').style.display = 'none';
    }

    // ƒê√≥ng modal khi ng∆∞·ªùi d√πng nh·∫•n v√†o b·∫•t k·ª≥ ƒë√¢u b√™n ngo√†i modal
    window.onclick = function(event) {
        const modal = document.getElementById('myModal');
        if (event.target == modal) {
            modal.style.display = 'none';
        }
    }

    // Th√™m s·ª± ki·ªán l·∫Øng nghe cho n√∫t Th√™m Ph√≤ng Ban
    document.getElementById('addDepartmentBtn').addEventListener('click', addDepartment);

    // ƒêi·ªÅn d·ªØ li·ªáu v√†o b·∫£ng khi t·∫£i trang
    document.addEventListener('DOMContentLoaded', fetchData);

    // H√†m ƒë·ªÉ t√¨m ki·∫øm trong b·∫£ng
    document.getElementById('searchInput').addEventListener('keyup', function() {
        const filter = this.value.toLowerCase();
        const rows = document.getElementById('departmentTable').getElementsByTagName('tbody')[0].getElementsByTagName('tr');
        Array.from(rows).forEach(row => {
            const cells = row.getElementsByTagName('td');
            const match = Array.from(cells).some(cell => cell.textContent.toLowerCase().includes(filter));
            row.style.display = match ? '' : 'none';
        });
    });

    // H√†m ƒë·ªÉ s·ª≠a ph√≤ng ban
    function editDepartment(index, departmentName, userName, roleName) {
        editIndex = index;
        document.getElementById('modalTitle').textContent = 'S·ª≠a Ph√≤ng Ban';
        document.getElementById('departmentName').value = departmentName;
        document.getElementById('userName').value = userName;
        document.getElementById('roleName').value = roleName;
        document.getElementById('addDepartmentForm').querySelector('input[type="submit"]').value = 'C·∫≠p Nh·∫≠t Ph√≤ng Ban';
        const modal = document.getElementById('myModal');
        modal.style.display = 'block';
    }

    // H√†m ƒë·ªÉ xo√° ph√≤ng ban
    function deleteDepartment(index) {
        // Logic ƒë·ªÉ xo√° ph√≤ng ban (v√≠ d·ª•: g·ª≠i y√™u c·∫ßu xo√° ƒë·∫øn backend)
        console.log('Xo√° ph√≤ng ban:', index);
    }
</script>
</body>
</html>